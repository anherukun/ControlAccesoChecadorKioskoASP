
@{
    ViewBag.Title = "Configuraciones";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@{
    // HttpCookie clientCookies = new HttpCookie("ControlAccessCheckerCookies");
    // clientCookies["prueba 1"] = "cookie del cliente";
    // clientCookies.Expires = DateTime.Now.AddYears(1);
    // Response.Cookies.Add(clientCookies);
}

<div class="row" style="margin-top: 16px">
    <h1 class="col-md-offset-3">Configuraciones</h1>

    <div class="col-md-8 col-md-offset-2 alert alert-danger" id="error-alert-snack" role="alert" style="margin-top: 16px; display:none;">
        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
        Debes completar correctamente el formulario
    </div>
    <div class="col-md-8 col-md-offset-2 alert alert-success" id="success-alert-snack" role="alert" style="margin-top: 16px; display:none;">
        <span class="glyphicon glyphicon-ok-sign" aria-hidden="true"></span>
        Los cambios se han guardado correctamente
    </div>
    <!--FORMULARIO DE CONFIGURACIONES-->
    <div class="col-md-6 col-md-offset-3" style="padding: 32px; background-color:#eeeeee; margin-top: 16px; box-shadow: 4px 4px 15px rgba(0, 0, 0, 0.40);">
        <div class="row">
            <script type="text/javascript">
                function moreRegisters() {
                    var input = document.forms["form"]["reg-count"];
                    input.value = Number(input.value) + 1;
                }
                function lessRegisters() {
                    var input = document.forms["form"]["reg-count"];
                    if (Number(input.value) > 0) {
                        input.value = Number(input.value) - 1;
                    }
                }

                function moreMinutes() {
                    var input = document.forms["form"]["update-time"];
                    input.value = Number(input.value) + 1;
                }
                function lessMinutes() {
                    var input = document.forms["form"]["update-time"];
                    if (Number(input.value) > 0) {
                        input.value = Number(input.value) - 1;
                    }
                }

                function isFormValid() {
                    var select = document.forms["form"]["departmentSelect"];
                    var regCount = document.forms["form"]["reg-count"];
                    var minCount = document.forms["form"]["update-time"];

                    return Number(select.value) > -1 && Number(regCount.value) > 0 && Number(minCount.value) > 0;
                }

                function saveToConfig() {
                    document.getElementById("success-alert-snack").style.display = "none";
                    document.getElementById("error-alert-snack").style.display = "none";
                    var select = document.forms["form"]["departmentSelect"];
                    var regCount = document.forms["form"]["reg-count"];
                    var minCount = document.forms["form"]["update-time"];

                    if (isFormValid()) {
                        document.getElementById("success-alert-snack").style.display = "block";
                    } else {
                        document.getElementById("error-alert-snack").style.display = "block";
                    }
                }
            </script>

            <form class="form-horizontal" id="form">
                <div class="form-group">
                    <label class="col-md-4 control-label">Departamento</label>
                    <div class="input-group col-md-5">
                        <select class="form-control" id="departmentSelect">
                            @{
                                <option value="-1">Selecciona el departamento...</option>

                                List<ControlAccesoChecadorKioskoASP.Models.Department> departments = ViewData["Departments"] as List<ControlAccesoChecadorKioskoASP.Models.Department>;
                                for (int i = 0; i < departments.Count; i++)
                                {
                                    <option value="@i">@departments[i].DepartmentId  @departments[i].Name</option>
                                }
                            }
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-md-4 control-label">Registros por mostrar</label>
                    <div class="input-group col-md-5">
                        <input type="text" class="form-control" id="reg-count" value="20" disabled>
                        <div class="input-group-btn">
                            <button type="button" class="btn btn-danger" onclick="lessRegisters()">
                                <span class="glyphicon glyphicon-minus" aria-hidden="true"></span>
                            </button>
                            <button type="button" class="btn btn-primary" onclick="moreRegisters()">
                                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-md-4 control-label">Minutos para refrescar</label>
                    <div class="input-group col-md-5">
                        <input type="text" class="form-control" id="update-time" value="3" disabled>
                        <div class="input-group-btn">
                            <button type="button" class="btn btn-danger" onclick="lessMinutes()">
                                <span class="glyphicon glyphicon-minus" aria-hidden="true"></span>
                            </button>
                            <button type="button" class="btn btn-primary" onclick="moreMinutes()">
                                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <div class="row" style="margin-top: 32px; padding-right: 16px; text-align:right">
            <a class="btn btn-success" onclick="saveToConfig()">
                <span class="glyphicon glyphicon-floppy-saved" aria-hidden="true"></span>  Guardar
            </a>
        </div>
    </div>
</div>
